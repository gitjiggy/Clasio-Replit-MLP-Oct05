Update CSP connect-src

In your server/security.ts (or wherever you call Helmet), ensure these directives:

import helmet from "helmet";

app.use(
  helmet.contentSecurityPolicy({
    useDefaults: false,
    directives: {
      "default-src": ["'self'"],

      "script-src": [
        "'self'",
        "'unsafe-inline'",
        // "'unsafe-eval'", // only if your Firebase SDK/build really needs it
        "https://apis.google.com",
        "https://www.gstatic.com",
        "https://www.googletagmanager.com",
        "https://www.google-analytics.com",
      ],
      "script-src-elem": [
        "'self'",
        "'unsafe-inline'",
        "https://apis.google.com",
        "https://www.gstatic.com",
        "https://www.googletagmanager.com",
        "https://www.google-analytics.com",
      ],

      // ⬇️ THIS is the piece you still need
      "connect-src": [
        "'self'",
        "https://apis.google.com",
        "https://www.googleapis.com",
        "https://securetoken.googleapis.com",
        "https://identitytoolkit.googleapis.com",
        "https://firebasestorage.googleapis.com",
        "https://firestore.googleapis.com",
        "https://www.gstatic.com",
        "https://www.google-analytics.com", // optional
      ],

      "frame-src": [
        "'self'",
        "https://accounts.google.com",
        "https://apis.google.com",
        "https://*.firebaseapp.com",
      ],
      "child-src": [
        "'self'",
        "https://accounts.google.com",
        "https://apis.google.com",
        "https://*.firebaseapp.com",
      ],

      "style-src": ["'self'", "'unsafe-inline'", "https://fonts.googleapis.com"],
      "font-src": ["'self'", "https://fonts.gstatic.com"],
      "img-src": ["'self'", "data:", "https://www.gstatic.com", "https://www.google-analytics.com"],
      "object-src": ["'none'"],
      "base-uri": ["'self'"],
      "frame-ancestors": ["'self'"],
    },
  })
);


If you don’t use GA, drop googletagmanager.com/google-analytics.com.