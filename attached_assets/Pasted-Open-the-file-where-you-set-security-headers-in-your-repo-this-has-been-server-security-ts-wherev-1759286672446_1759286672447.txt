Open the file where you set security headers (in your repo this has been server/security.ts / wherever helmet() is used).

Replace the CSP config with this (works with Helmet on Express):

import helmet from "helmet";

app.use(
  helmet({
    contentSecurityPolicy: {
      useDefaults: false,
      directives: {
        "default-src": ["'self'"],

        // allow fonts/css from Google Fonts if you use them
        "style-src": ["'self'", "'unsafe-inline'", "https://fonts.googleapis.com"],
        "font-src": ["'self'", "https://fonts.gstatic.com", "data:"],

        // scripts you load in the page (Firebase, gapi, GTM)
        "script-src": [
          "'self'",
          "'unsafe-inline'",
          "https://apis.google.com",
          "https://www.gstatic.com",
          "https://www.googletagmanager.com"
        ],
        "script-src-elem": [
          "'self'",
          "'unsafe-inline'",
          "https://apis.google.com",
          "https://www.gstatic.com",
          "https://www.googletagmanager.com"
          // Optional: uncomment if you want the Replit banner to load
          //, "https://replit.com"
        ],

        // *** THIS is the big one â€“ allow Firebase/Google backends ***
        "connect-src": [
          "'self'",
          "https://www.googleapis.com",
          "https://securetoken.googleapis.com",
          "https://identitytoolkit.googleapis.com",
          "https://firebasestorage.googleapis.com",
          "https://firestore.googleapis.com",
          "https://content-firebaseappcheck.googleapis.com",
          "https://oauth2.googleapis.com",
          "https://accounts.google.com",
          "https://openidconnect.googleapis.com",
          // optional (only if you use GA)
          "https://www.google-analytics.com"
        ],

        // Firebase/GSI popups / iframes
        "frame-src": ["'self'", "https://accounts.google.com", "https://apis.google.com"],

        // images & avatars
        "img-src": ["'self'", "data:", "https://*.googleusercontent.com", "https://www.gstatic.com"],

        // keep the rest tight:
        "media-src": ["'self'", "blob:"],
        "worker-src": ["'self'", "blob:"],
        "object-src": ["'none'"],
        "base-uri": ["'self'"],
        "frame-ancestors": ["'self'"],
        "upgrade-insecure-requests": []
      }
    },

    // These two often need to be off when using iframes/GA on modern browsers
    crossOriginEmbedderPolicy: false,
    crossOriginResourcePolicy: false
  })
);